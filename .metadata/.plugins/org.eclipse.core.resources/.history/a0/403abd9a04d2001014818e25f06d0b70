package br.edu.universidade.repositorio_extensao.service;

import br.edu.universidade.repositorio_extensao.model.AcaoDeExtensao;
import br.edu.universidade.repositorio_extensao.model.Responsavel;

import java.time.LocalDate;
import java.util.ArrayList;
import java.util.List;
import java.util.stream.Collectors;

public class AcaoService {

    private final List<AcaoDeExtensao> todasAcoes = new ArrayList<>();

    public AcaoService() {

        todasAcoes.add(new AcaoDeExtensao(
                101,
                "Curso de Inovação em Tecnologias Web (Front-end)",
                "Vigente",
                "Treinamento intensivo em React e Vue.js para estudantes de TI.",
                "Este curso visa capacitar os participantes nas últimas tendências de desenvolvimento front-end.",
                LocalDate.of(2025, 3, 1),
                LocalDate.of(2025, 6, 30),
                "Campus Central, Bloco B",
                new Responsavel("Prof. João Silva", "joao.silva@uni.edu"),
                true,
                "https://universidade.br/inscricao-inovacao-web"
        ));

        todasAcoes.add(new AcaoDeExtensao(
                205,
                "Oficina de Libras para a Comunidade",
                "Encerrada",
                "Introdução à Língua Brasileira de Sinais.",
                "Oficina gratuita com foco em conversação básica e inclusão.",
                LocalDate.of(2024, 9, 15),
                LocalDate.of(2024, 10, 15),
                "Polo Comunitário I",
                new Responsavel("Profa. Maria Oliveira", "maria.oliver@uni.edu"),
                false,
                ""
        ));

        todasAcoes.add(new AcaoDeExtensao(
                300,
                "Seminário de Sustentabilidade Urbana",
                "Vigente",
                "Discussão sobre soluções ecológicas para cidades modernas.",
                "Evento com especialistas em ecologia e urbanismo.",
                LocalDate.of(2025, 5, 10),
                LocalDate.of(2025, 5, 12),
                "Auditório Principal",
                new Responsavel("Dr. Carlos Mendes", "carlos.mendes@uni.edu"),
                true,
                "https://universidade.br/seminario-sustentabilidade"
        ));
    }

    public List<AcaoDeExtensao> buscarAcoes(String termoBusca, String statusFiltro) {
        return todasAcoes.stream()
            .filter(acao -> {

                boolean statusMatch =
                        (statusFiltro == null || statusFiltro.equalsIgnoreCase("Todos"))
                        || acao.getStatus().equalsIgnoreCase(statusFiltro);

                boolean termoMatch = true;
                if (termoBusca != null && !termoBusca.trim().isEmpty()) {
                    String termo = termoBusca.toLowerCase();
                    termoMatch =
                            acao.getTitulo().toLowerCase().contains(termo) ||
                            acao.getDescricaoCurta().toLowerCase().contains(termo);
                }

                return statusMatch && termoMatch;
            })
            .collect(Collectors.toList());
    }
}
